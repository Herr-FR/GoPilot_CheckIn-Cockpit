<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interaktiver Check-In & Lern-Reflexion</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Placeholder Comments Required by Prompt -->
    <!-- Chosen Palette: Warm Neutrals & Calming Accents (Stone, Teal, Indigo) -->
    <!-- Application Structure Plan: 5-stage Wizard flow (Check-In -> Retro -> Strategy -> Plan -> Cockpit). Added 'Free Text' to Plan section. -->
    <!-- Visualization & Content Choices: Radar Chart, Sliders, Text inputs. CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        /* Custom Chart Container Styling as per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Custom Range Slider Styling */
        input[type=range] {
            -webkit-appearance: none; 
            width: 100%; 
            background: transparent; 
        }
        
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #0d9488; /* Teal-600 */
            cursor: pointer;
            margin-top: -8px; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }
        
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 8px;
            cursor: pointer;
            background: #e7e5e4; /* Stone-200 */
            border-radius: 4px;
        }

        /* Utility for hiding scrollbar in navigation but keeping functionality */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-800 font-sans antialiased min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-stone-200 sticky top-0 z-50">
        <div class="max-w-5xl mx-auto px-4 py-4 flex flex-col sm:flex-row justify-between items-center gap-4">
            <div class="flex items-center gap-2">
                <span class="text-3xl">ğŸ§­</span>
                <div>
                    <h1 class="text-xl font-bold text-stone-800">Lern-Check-In</h1>
                    <p class="text-xs text-stone-500">Interaktiver Reflexionsbogen</p>
                </div>
            </div>
            <div class="flex items-center gap-2 w-full sm:w-auto">
                <input type="text" id="studentName" placeholder="Dein Name..." class="px-4 py-2 rounded-lg border border-stone-300 focus:outline-none focus:ring-2 focus:ring-teal-500 w-full sm:w-64 bg-stone-50 text-sm">
                <span id="dateDisplay" class="text-xs text-stone-400 font-mono hidden sm:block"></span>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-grow max-w-4xl w-full mx-auto px-4 py-8">
        
        <!-- Navigation Tabs -->
        <nav class="flex overflow-x-auto no-scrollbar gap-2 mb-8 pb-2 border-b border-stone-200">
            <button onclick="app.switchTab('status')" id="nav-status" class="nav-btn whitespace-nowrap px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border-b-2 border-teal-600 text-teal-800 bg-teal-50">1. Status Quo</button>
            <button onclick="app.switchTab('retro')" id="nav-retro" class="nav-btn whitespace-nowrap px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border-b-2 border-transparent text-stone-500 hover:text-stone-700 hover:bg-stone-100">2. RÃ¼ckblick</button>
            <button onclick="app.switchTab('strategy')" id="nav-strategy" class="nav-btn whitespace-nowrap px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border-b-2 border-transparent text-stone-500 hover:text-stone-700 hover:bg-stone-100">3. Strategie</button>
            <button onclick="app.switchTab('plan')" id="nav-plan" class="nav-btn whitespace-nowrap px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border-b-2 border-transparent text-stone-500 hover:text-stone-700 hover:bg-stone-100">4. Der Plan</button>
            <button onclick="app.switchTab('cockpit')" id="nav-cockpit" class="nav-btn whitespace-nowrap px-4 py-2 rounded-t-lg font-medium text-sm transition-colors border-b-2 border-transparent text-indigo-600 hover:text-indigo-800 hover:bg-indigo-50">ğŸ“Š Cockpit (Ergebnis)</button>
        </nav>

        <!-- VIEW 1: STATUS QUO -->
        <section id="view-status" class="view-section animate-fade-in">
            <div class="mb-6 bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                <h2 class="text-lg font-bold text-teal-900 mb-2">Wie ist die aktuelle Lage?</h2>
                <p class="text-sm text-stone-600">
                    Bevor wir Ã¼ber Inhalte sprechen, mÃ¼ssen wir das Fundament klÃ¤ren. Lernen funktioniert nur, wenn Energie und Motivation vorhanden sind. Nutze diese Regler, um deinen aktuellen Zustand ehrlich einzuschÃ¤tzen. Das hilft uns, realistische Ziele zu setzen.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Energy -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <div class="flex justify-between items-center mb-4">
                        <label class="font-bold text-stone-700">ğŸ”‹ Energie-Level (Akku)</label>
                        <span id="val-energy" class="text-2xl font-bold text-teal-600">3/5</span>
                    </div>
                    <div class="flex justify-between text-2xl mb-2 px-2">
                        <span class="cursor-pointer opacity-50 hover:opacity-100" onclick="app.setEnergy(1)">ğŸª«</span>
                        <span class="cursor-pointer opacity-50 hover:opacity-100" onclick="app.setEnergy(2)">ğŸ”Œ</span>
                        <span class="cursor-pointer opacity-50 hover:opacity-100" onclick="app.setEnergy(3)">ğŸ”‹</span>
                        <span class="cursor-pointer opacity-50 hover:opacity-100" onclick="app.setEnergy(4)">âš¡</span>
                        <span class="cursor-pointer opacity-50 hover:opacity-100" onclick="app.setEnergy(5)">ğŸš€</span>
                    </div>
                    <input type="range" min="1" max="5" value="3" id="input-energy" class="w-full accent-teal-600" oninput="app.updateEnergy(this.value)">
                    <div class="flex justify-between text-xs text-stone-400 mt-2">
                        <span>Leer</span>
                        <span>Voll</span>
                    </div>
                </div>

                <!-- Motivation -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <div class="flex justify-between items-center mb-4">
                        <label class="font-bold text-stone-700">ğŸ¤© Motivation</label>
                        <span id="val-motivation" class="text-2xl font-bold text-teal-600">3/5</span>
                    </div>
                    <div class="flex justify-between text-2xl mb-2 px-2">
                        <span class="cursor-pointer opacity-50 hover:opacity-100" onclick="app.setMotivation(1)">ğŸ¥±</span>
                        <span class="cursor-pointer opacity-50 hover:opacity-100" onclick="app.setMotivation(2)">ğŸ˜•</span>
                        <span class="cursor-pointer opacity-50 hover:opacity-100" onclick="app.setMotivation(3)">ğŸ˜</span>
                        <span class="cursor-pointer opacity-50 hover:opacity-100" onclick="app.setMotivation(4)">ğŸ™‚</span>
                        <span class="cursor-pointer opacity-50 hover:opacity-100" onclick="app.setMotivation(5)">ğŸ¤©</span>
                    </div>
                    <input type="range" min="1" max="5" value="3" id="input-motivation" class="w-full accent-teal-600" oninput="app.updateMotivation(this.value)">
                    <div class="flex justify-between text-xs text-stone-400 mt-2">
                        <span>Langeweile</span>
                        <span>Begeisterung</span>
                    </div>
                </div>
            </div>

            <!-- Feelings Tags -->
            <div class="mt-6 bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                <label class="block font-bold text-stone-700 mb-3">Ich fÃ¼hle mich aktuell...</label>
                <div class="flex flex-wrap gap-3" id="feelings-container">
                    <!-- JS will populate buttons -->
                </div>
            </div>

            <div class="mt-8 flex justify-end">
                <button onclick="app.switchTab('retro')" class="bg-teal-600 hover:bg-teal-700 text-white px-6 py-2 rounded-lg font-bold shadow-md transition-transform transform active:scale-95 flex items-center gap-2">
                    Weiter zum RÃ¼ckblick â”
                </button>
            </div>
        </section>

        <!-- VIEW 2: RÃœCKBLICK -->
        <section id="view-retro" class="view-section hidden animate-fade-in">
            <div class="mb-6 bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                <h2 class="text-lg font-bold text-teal-900 mb-2">RÃ¼ckblick: Analyse der Vergangenheit</h2>
                <p class="text-sm text-stone-600">
                    Aus Fehlern lernt man oft mehr als aus Erfolgen, aber Erfolge geben Kraft. Hier analysieren wir, was passiert ist. Identifiziere deine "High Fives" und deine Stolpersteine.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Success -->
                <div class="bg-emerald-50 p-6 rounded-xl border border-emerald-100">
                    <label class="block font-bold text-emerald-800 mb-2">ğŸ† High Five Moment</label>
                    <p class="text-xs text-emerald-600 mb-3">Was war dein grÃ¶ÃŸter Erfolg?</p>
                    <textarea id="input-success" class="w-full h-32 p-3 rounded-lg border-emerald-200 bg-white focus:ring-2 focus:ring-emerald-400 focus:border-transparent resize-none text-sm" placeholder="Ich war stolz darauf, dass..."></textarea>
                </div>

                <!-- Hurdles -->
                <div class="bg-rose-50 p-6 rounded-xl border border-rose-100">
                    <label class="block font-bold text-rose-800 mb-2">ğŸš§ HÃ¼rde / Stolperstein</label>
                    <p class="text-xs text-rose-600 mb-3">Wo gab es Probleme?</p>
                    <textarea id="input-hurdle" class="w-full h-32 p-3 rounded-lg border-rose-200 bg-white focus:ring-2 focus:ring-rose-400 focus:border-transparent resize-none text-sm" placeholder="Schwierig war fÃ¼r mich..."></textarea>
                </div>
            </div>

            <!-- Hurdle Causes -->
            <div class="mt-6 bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                <label class="block font-bold text-stone-700 mb-3">Woran lag es (HÃ¼rden-Ursache)?</label>
                <div class="flex flex-wrap gap-3" id="hurdles-container">
                    <!-- JS populated -->
                </div>
            </div>

            <div class="mt-8 flex justify-between">
                <button onclick="app.switchTab('status')" class="text-stone-500 hover:text-stone-700 px-4">ZurÃ¼ck</button>
                <button onclick="app.switchTab('strategy')" class="bg-teal-600 hover:bg-teal-700 text-white px-6 py-2 rounded-lg font-bold shadow-md transition-transform transform active:scale-95 flex items-center gap-2">
                    Weiter zu Strategien â”
                </button>
            </div>
        </section>

        <!-- VIEW 3: STRATEGIE -->
        <section id="view-strategy" class="view-section hidden animate-fade-in">
            <div class="mb-6 bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                <h2 class="text-lg font-bold text-teal-900 mb-2">Wie hast du gelernt? (Metakognition)</h2>
                <p class="text-sm text-stone-600">
                    Es geht nicht nur darum, *was* wir lernen, sondern *wie*. "BeschÃ¤ftigung mit dem Stoff" ist nicht gleich Lernen. Hier prÃ¼fen wir deine Werkzeuge und die Tiefe deiner Verarbeitung.
                </p>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200 mb-6">
                <label class="block font-bold text-stone-700 mb-4">ğŸ§° Genutzte Werkzeuge & Methoden</label>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3" id="strategies-container">
                    <!-- JS Populated -->
                </div>
            </div>

            <!-- Cognitive Depth Slider -->
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-indigo-100">
                <div class="flex justify-between items-end mb-4">
                    <div>
                        <label class="block font-bold text-indigo-900">ğŸ§  Kognitive Tiefe</label>
                        <p class="text-xs text-indigo-600 mt-1">Hast du nur fÃ¼r den Test gelernt oder wirklich verstanden?</p>
                    </div>
                    <span id="val-depth" class="text-3xl font-bold text-indigo-600">5/10</span>
                </div>
                
                <div class="relative pt-6 pb-2 px-2">
                    <input type="range" min="1" max="10" value="5" id="input-depth" class="w-full accent-indigo-600" oninput="app.updateDepth(this.value)">
                </div>
                
                <div class="flex justify-between text-xs font-medium text-stone-500 mt-2 px-1">
                    <div class="text-left w-1/3">
                        <span class="block font-bold text-stone-700">OberflÃ¤chlich (1-3)</span>
                        Durchlesen, Markieren, Auswendiglernen (Bulimie-Lernen)
                    </div>
                    <div class="text-center w-1/3 border-l border-r border-stone-300">
                        <span class="block font-bold text-stone-700">Verarbeitend (4-7)</span>
                        Zusammenfassen, Strukturieren, Ordnen
                    </div>
                    <div class="text-right w-1/3">
                        <span class="block font-bold text-stone-700">Tief (8-10)</span>
                        ErklÃ¤ren, Transfer, Kritisieren, VerknÃ¼pfen
                    </div>
                </div>
            </div>

            <div class="mt-8 flex justify-between">
                <button onclick="app.switchTab('retro')" class="text-stone-500 hover:text-stone-700 px-4">ZurÃ¼ck</button>
                <button onclick="app.switchTab('plan')" class="bg-teal-600 hover:bg-teal-700 text-white px-6 py-2 rounded-lg font-bold shadow-md transition-transform transform active:scale-95 flex items-center gap-2">
                    Weiter zum Plan â”
                </button>
            </div>
        </section>

        <!-- VIEW 4: DER PLAN -->
        <section id="view-plan" class="view-section hidden animate-fade-in">
            <div class="mb-6 bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                <h2 class="text-lg font-bold text-teal-900 mb-2">Der Plan: Transfer in die Zukunft</h2>
                <p class="text-sm text-stone-600">
                    Erkenntnis ohne Handlung ist wertlos. Wir nutzen die "Start / Stop / Continue" Methode, um ganz konkrete Vereinbarungen fÃ¼r die nÃ¤chste Woche zu treffen.
                </p>
            </div>

            <div class="space-y-4">
                <!-- START -->
                <div class="flex flex-col sm:flex-row gap-4 bg-white p-4 rounded-xl border-l-4 border-emerald-500 shadow-sm">
                    <div class="sm:w-32 flex-shrink-0 flex items-center">
                        <div class="bg-emerald-100 text-emerald-700 p-2 rounded-lg font-bold w-full text-center">ğŸŸ¢ START</div>
                    </div>
                    <div class="flex-grow">
                        <label class="text-xs uppercase font-bold text-stone-400">Was fange ich neu an?</label>
                        <input type="text" id="input-start" class="w-full mt-1 p-2 border-b border-stone-200 focus:border-emerald-500 focus:outline-none bg-transparent transition-colors" placeholder="z.B. Handy vor dem Lernen weglegen...">
                    </div>
                </div>

                <!-- STOP -->
                <div class="flex flex-col sm:flex-row gap-4 bg-white p-4 rounded-xl border-l-4 border-rose-500 shadow-sm">
                    <div class="sm:w-32 flex-shrink-0 flex items-center">
                        <div class="bg-rose-100 text-rose-700 p-2 rounded-lg font-bold w-full text-center">ğŸ”´ STOP</div>
                    </div>
                    <div class="flex-grow">
                        <label class="text-xs uppercase font-bold text-stone-400">Was lasse ich sein?</label>
                        <input type="text" id="input-stop" class="w-full mt-1 p-2 border-b border-stone-200 focus:border-rose-500 focus:outline-none bg-transparent transition-colors" placeholder="z.B. Lernen auf den letzten DrÃ¼cker...">
                    </div>
                </div>

                <!-- CONTINUE -->
                <div class="flex flex-col sm:flex-row gap-4 bg-white p-4 rounded-xl border-l-4 border-blue-500 shadow-sm">
                    <div class="sm:w-32 flex-shrink-0 flex items-center">
                        <div class="bg-blue-100 text-blue-700 p-2 rounded-lg font-bold w-full text-center">ğŸ”µ CONTINUE</div>
                    </div>
                    <div class="flex-grow">
                        <label class="text-xs uppercase font-bold text-stone-400">Was behalte ich bei?</label>
                        <input type="text" id="input-continue" class="w-full mt-1 p-2 border-b border-stone-200 focus:border-blue-500 focus:outline-none bg-transparent transition-colors" placeholder="z.B. Karteikarten schreiben...">
                    </div>
                </div>

                <!-- FREE TEXT NOTES (New Feature) -->
                <div class="bg-white p-4 rounded-xl border border-stone-200 shadow-sm">
                    <label class="block font-bold text-stone-700 mb-2">ğŸ“ Sonstiges / Freie Notizen</label>
                    <p class="text-xs text-stone-500 mb-2">Platz fÃ¼r zusÃ¤tzliche Gedanken, WÃ¼nsche oder Anmerkungen.</p>
                    <textarea id="input-notes" class="w-full h-24 p-3 rounded-lg border-stone-200 bg-stone-50 focus:ring-2 focus:ring-teal-400 focus:border-transparent resize-none text-sm" placeholder="Hier ist Platz fÃ¼r alles Weitere..."></textarea>
                </div>

                <!-- Main Goal -->
                <div class="mt-6 bg-stone-800 text-white p-6 rounded-xl shadow-lg">
                    <label class="block font-bold text-teal-400 mb-2">ğŸ¯ Mein Hauptziel bis zum nÃ¤chsten GesprÃ¤ch:</label>
                    <input type="text" id="input-goal" class="w-full bg-stone-700 border border-stone-600 rounded p-3 text-white focus:ring-2 focus:ring-teal-500 focus:outline-none" placeholder="Hier das wichtigste Ziel eintragen...">
                </div>
            </div>

            <div class="mt-8 flex justify-between">
                <button onclick="app.switchTab('strategy')" class="text-stone-500 hover:text-stone-700 px-4">ZurÃ¼ck</button>
                <button onclick="app.switchTab('cockpit')" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-bold shadow-md transition-transform transform active:scale-95 flex items-center gap-2">
                    Zum Cockpit (Auswertung) ğŸ“Š
                </button>
            </div>
        </section>

        <!-- VIEW 5: COCKPIT (SUMMARY) -->
        <section id="view-cockpit" class="view-section hidden animate-fade-in">
            <div class="mb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white p-6 rounded-xl shadow-sm border border-indigo-100">
                <div>
                    <h2 class="text-lg font-bold text-indigo-900 mb-1">Reflexions-Cockpit</h2>
                    <p class="text-sm text-stone-600">Zusammenfassung fÃ¼r das GesprÃ¤ch</p>
                </div>
                <button onclick="window.print()" class="bg-stone-200 hover:bg-stone-300 text-stone-700 px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2">
                    ğŸ–¨ï¸ Drucken / PDF
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- CHART 1: Balance Radar -->
                <div class="bg-white p-4 rounded-xl shadow-sm border border-stone-200">
                    <h3 class="text-sm font-bold text-stone-500 mb-4 text-center">Balance: Energie vs. Motivation vs. Tiefe</h3>
                    <div class="chart-container">
                        <canvas id="radarChart"></canvas>
                    </div>
                    <p class="text-xs text-center text-stone-400 mt-2">Ideal: Ein groÃŸes, ausgeglichenes Dreieck.</p>
                </div>

                <!-- Qualitative Summary -->
                <div class="space-y-4">
                    <!-- Text Summary Block -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-stone-200 h-full">
                        <h3 class="text-sm font-bold text-stone-500 mb-4 border-b pb-2">Die wichtigsten Punkte</h3>
                        
                        <div class="mb-4">
                            <span class="text-xs font-bold text-emerald-600 uppercase">Erfolg</span>
                            <p id="summary-success" class="text-sm text-stone-700 italic">Noch kein Eintrag...</p>
                        </div>
                        
                        <div class="mb-4">
                            <span class="text-xs font-bold text-rose-600 uppercase">HÃ¼rde</span>
                            <p id="summary-hurdle" class="text-sm text-stone-700 italic">Noch kein Eintrag...</p>
                        </div>

                        <div class="mb-4">
                            <span class="text-xs font-bold text-indigo-600 uppercase">Fokus-Strategien</span>
                            <div id="summary-strategies" class="flex flex-wrap gap-2 mt-1">
                                <!-- JS Populated -->
                            </div>
                        </div>

                        <!-- New Summary Field for Notes -->
                        <div>
                            <span class="text-xs font-bold text-stone-500 uppercase">Sonstige Notizen</span>
                            <p id="summary-notes" class="text-sm text-stone-700 italic">Keine Notizen.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Plan Summary -->
            <div class="bg-stone-800 text-stone-200 p-6 rounded-xl shadow-md mb-8">
                <h3 class="text-teal-400 font-bold mb-4 uppercase text-sm tracking-wider">Vereinbarungen</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                    <div class="bg-stone-700 p-3 rounded">
                        <span class="text-emerald-400 font-bold block mb-1">ğŸŸ¢ START</span>
                        <span id="summary-start">-</span>
                    </div>
                    <div class="bg-stone-700 p-3 rounded">
                        <span class="text-rose-400 font-bold block mb-1">ğŸ”´ STOP</span>
                        <span id="summary-stop">-</span>
                    </div>
                    <div class="bg-stone-700 p-3 rounded">
                        <span class="text-blue-400 font-bold block mb-1">ğŸ”µ CONTINUE</span>
                        <span id="summary-continue">-</span>
                    </div>
                </div>
                <div class="mt-4 pt-4 border-t border-stone-600">
                    <span class="text-stone-400 text-xs uppercase">Hauptziel:</span>
                    <p id="summary-goal" class="text-lg font-bold text-white mt-1">-</p>
                </div>
            </div>

            <!-- Hidden Charts for Print/Expansion -->
             <div class="hidden">
                 <!-- Could add more analytics here later -->
             </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-stone-100 py-6 border-t border-stone-200 mt-auto print:hidden">
        <div class="max-w-4xl mx-auto px-4 text-center text-xs text-stone-400">
            <p>Interaktives Reflexionstool | Daten werden nicht gespeichert (Session-Only).</p>
        </div>
    </footer>

    <!-- Application Logic -->
    <script>
        const app = {
            state: {
                energy: 3,
                motivation: 3,
                depth: 5,
                feelings: [],
                hurdleCauses: [],
                strategies: [],
                success: '',
                hurdle: '',
                start: '',
                stop: '',
                continue: '',
                goal: '',
                notes: '' // Added state for notes
            },
            
            // Configuration Data
            config: {
                feelings: [
                    { id: 'stressed', label: 'ğŸ˜° Gestresst' },
                    { id: 'bored', label: 'ğŸ¥± Gelangweilt' },
                    { id: 'secure', label: 'ğŸ˜ Kompetent' },
                    { id: 'curious', label: 'ğŸ§ Neugierig' },
                    { id: 'tired', label: 'ğŸ˜´ MÃ¼de' },
                    { id: 'motivated', label: 'ğŸ”¥ Motiviert' }
                ],
                hurdleCauses: [
                    { id: 'time', label: 'â³ Zeitmangel' },
                    { id: 'understanding', label: 'â“ VerstÃ¤ndnis' },
                    { id: 'distraction', label: 'ğŸ“± Ablenkung' },
                    { id: 'strategy', label: 'ğŸ”§ Falsche Strategie' }
                ],
                strategies: [
                    { id: 'summary', label: 'ğŸ“ Zusammenfassung' },
                    { id: 'mindmap', label: 'ğŸ§  Mindmap' },
                    { id: 'explain', label: 'ğŸ—£ï¸ ErklÃ¤ren (Feynman)' },
                    { id: 'flashcards', label: 'ğŸ—‚ï¸ Karteikarten' },
                    { id: 'reading', label: 'ğŸ“– Nur Lesen (Passiv)' },
                    { id: 'video', label: 'ğŸ“º Videos' },
                    { id: 'practice', label: 'âœï¸ Aufgaben lÃ¶sen' }
                ]
            },

            charts: {
                radar: null
            },

            init() {
                // Set Date
                document.getElementById('dateDisplay').textContent = new Date().toLocaleDateString('de-DE', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

                // Render Toggle Buttons
                this.renderToggles('feelings-container', this.config.feelings, 'feelings');
                this.renderToggles('hurdles-container', this.config.hurdleCauses, 'hurdleCauses');
                this.renderToggles('strategies-container', this.config.strategies, 'strategies');

                // Bind Text Inputs
                this.bindInput('input-success', 'success');
                this.bindInput('input-hurdle', 'hurdle');
                this.bindInput('input-start', 'start');
                this.bindInput('input-stop', 'stop');
                this.bindInput('input-continue', 'continue');
                this.bindInput('input-notes', 'notes'); // Bind new input
                this.bindInput('input-goal', 'goal');

                // Init Chart
                this.initCharts();
            },

            // --- Navigation ---
            switchTab(tabId) {
                // Hide all views
                document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
                // Show target
                document.getElementById('view-' + tabId).classList.remove('hidden');
                
                // Update Nav Styling
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('border-teal-600', 'text-teal-800', 'bg-teal-50', 'border-indigo-600', 'text-indigo-800', 'bg-indigo-50');
                    btn.classList.add('border-transparent', 'text-stone-500');
                    // Special styling for Cockpit
                    if(btn.id === 'nav-cockpit') btn.classList.add('text-indigo-600');
                });

                const activeBtn = document.getElementById('nav-' + tabId);
                activeBtn.classList.remove('border-transparent', 'text-stone-500');
                if(tabId === 'cockpit') {
                    activeBtn.classList.add('border-indigo-600', 'text-indigo-800', 'bg-indigo-50');
                    this.updateCockpit(); // Refresh data when entering cockpit
                } else {
                    activeBtn.classList.add('border-teal-600', 'text-teal-800', 'bg-teal-50');
                }
                
                // Scroll to top
                window.scrollTo(0,0);
            },

            // --- Core Interaction Handling ---
            
            // Sliders
            setEnergy(val) {
                this.state.energy = parseInt(val);
                document.getElementById('input-energy').value = val;
                this.updateEnergy(val);
            },
            updateEnergy(val) {
                this.state.energy = parseInt(val);
                document.getElementById('val-energy').textContent = val + "/5";
            },

            setMotivation(val) {
                this.state.motivation = parseInt(val);
                document.getElementById('input-motivation').value = val;
                this.updateMotivation(val);
            },
            updateMotivation(val) {
                this.state.motivation = parseInt(val);
                document.getElementById('val-motivation').textContent = val + "/5";
            },

            updateDepth(val) {
                this.state.depth = parseInt(val);
                document.getElementById('val-depth').textContent = val + "/10";
            },

            // Toggle Buttons (Generic)
            renderToggles(containerId, items, stateKey) {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                items.forEach(item => {
                    const btn = document.createElement('button');
                    btn.className = `px-4 py-2 rounded-lg border text-sm font-medium transition-all duration-200 select-none ${
                        this.state[stateKey].includes(item.id) 
                        ? 'bg-stone-800 text-white border-stone-800 shadow-md transform scale-105' 
                        : 'bg-white text-stone-600 border-stone-300 hover:bg-stone-50'
                    }`;
                    btn.textContent = item.label;
                    btn.onclick = () => this.toggleItem(item.id, stateKey, btn);
                    container.appendChild(btn);
                });
            },

            toggleItem(id, stateKey, btnElement) {
                const index = this.state[stateKey].indexOf(id);
                if (index === -1) {
                    this.state[stateKey].push(id);
                    // Update UI active state
                    btnElement.classList.remove('bg-white', 'text-stone-600', 'border-stone-300');
                    btnElement.classList.add('bg-stone-800', 'text-white', 'border-stone-800', 'shadow-md', 'scale-105');
                } else {
                    this.state[stateKey].splice(index, 1);
                    // Update UI inactive state
                    btnElement.classList.add('bg-white', 'text-stone-600', 'border-stone-300');
                    btnElement.classList.remove('bg-stone-800', 'text-white', 'border-stone-800', 'shadow-md', 'scale-105');
                }
            },

            bindInput(elemId, stateKey) {
                const el = document.getElementById(elemId);
                el.addEventListener('input', (e) => {
                    this.state[stateKey] = e.target.value;
                });
            },

            // --- Visualization Logic ---
            initCharts() {
                const ctxRadar = document.getElementById('radarChart').getContext('2d');
                
                this.charts.radar = new Chart(ctxRadar, {
                    type: 'radar',
                    data: {
                        labels: ['Energie', 'Motivation', 'Kognitive Tiefe'],
                        datasets: [{
                            label: 'Dein Profil',
                            data: [3, 3, 5], // Init values (Depth is 1-10, others 1-5, need normalization in update)
                            fill: true,
                            backgroundColor: 'rgba(13, 148, 136, 0.2)', // teal-600 with opacity
                            borderColor: 'rgb(13, 148, 136)',
                            pointBackgroundColor: 'rgb(13, 148, 136)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(13, 148, 136)'
                        }]
                    },
                    options: {
                        maintainAspectRatio: false,
                        elements: {
                            line: { borderWidth: 3 }
                        },
                        scales: {
                            r: {
                                angleLines: { display: false },
                                suggestedMin: 0,
                                suggestedMax: 10,
                                ticks: { display: false } // Hide numbers for cleaner look
                            }
                        },
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            },

            updateCockpit() {
                // 1. Update Text Summaries
                const setText = (id, val, emptyMsg) => {
                    document.getElementById(id).textContent = val && val.trim() !== '' ? val : emptyMsg;
                    if(val && val.trim() !== '') document.getElementById(id).classList.remove('italic');
                    else document.getElementById(id).classList.add('italic');
                };

                setText('summary-success', this.state.success, 'Kein Erfolgserlebnis eingetragen.');
                setText('summary-hurdle', this.state.hurdle, 'Keine HÃ¼rde eingetragen.');
                setText('summary-start', this.state.start, '-');
                setText('summary-stop', this.state.stop, '-');
                setText('summary-continue', this.state.continue, '-');
                setText('summary-notes', this.state.notes, 'Keine Notizen.');
                setText('summary-goal', this.state.goal, 'Kein Ziel definiert.');

                // Strategies Badges in Summary
                const stratContainer = document.getElementById('summary-strategies');
                stratContainer.innerHTML = '';
                if(this.state.strategies.length === 0) {
                    stratContainer.innerHTML = '<span class="text-xs text-stone-400 italic">Keine ausgewÃ¤hlt</span>';
                } else {
                    this.state.strategies.forEach(sid => {
                        const stratConfig = this.config.strategies.find(s => s.id === sid);
                        if(stratConfig) {
                            const badge = document.createElement('span');
                            badge.className = 'bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded font-medium';
                            badge.textContent = stratConfig.label;
                            stratContainer.appendChild(badge);
                        }
                    });
                }

                // 2. Update Charts
                if(this.charts.radar) {
                    // Normalize Energy/Motivation (1-5) to (2-10) for the chart to match Depth (1-10) visual weight
                    const normEnergy = this.state.energy * 2;
                    const normMotivation = this.state.motivation * 2;
                    
                    this.charts.radar.data.datasets[0].data = [
                        normEnergy, 
                        normMotivation, 
                        this.state.depth
                    ];
                    this.charts.radar.update();
                }
            }
        };

        // Start App
        window.addEventListener('DOMContentLoaded', () => {
            app.init();
        });
    </script>
</body>
</html>